{"tag":"命令行","isDark":false,"type":"tag","path":"tags/命令行/","json_base":"data/tags/命令行/","json":"data/tags/命令行/1.json","current":1,"total":1,"posts":[{"type":"post","json_base":"data/posts","json":"data/posts/2012/05/11/windows-sudo-batch.json","path":"2012/05/11/windows-sudo-batch/","data":{"title":"用批处理在Windows下实现sudo命令","content":"<p>在Windows下运行某些命令的时候，必须要管理员权限。每次要重新选择“以管理员权限运行”很不方便而且没有效率，于是写了一个批处理文件，实现类似Linux下的sudo命令。</p>\n<p>保存为sudo.bat，放在环境变量PATH中指定的任意一个文件夹下，在命令行窗口中输入：</p>\n<blockquote>\n<p>sudo [command line]</p>\n</blockquote>\n<p>就会出现UAC对话框，确认后就会以管理员权限执行指定的命令。</p>\n<a id=\"more\"></a>\n<figure class=\"highlight\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">@Echo off&#10;:: Check for permissions&#10;&#38;gt;nul 2&#38;gt;&#38;amp;1 &#34;%SYSTEMROOT%\\system32\\cacls.exe&#34; &#34;%SYSTEMROOT%\\system32\\config\\system&#34;&#10;&#10;:: If error flag set, we do not have admin.&#10;if &#39;%errorlevel%&#39; NEQ &#39;0&#39; (&#10;Echo Requesting administrative privileges...&#10;goto UACPrompt&#10;) else ( goto gotAdmin )&#10;&#10;:UACPrompt&#10;Echo Set UAC = CreateObject^(&#34;Shell.Application&#34;^) &#38;gt; &#34;%temp%\\getadmin.vbs&#34;&#10;Echo UAC.ShellExecute &#34;%~s0&#34;, &#34;%*&#34;, &#34;&#34;, &#34;runas&#34;, 1 &#38;gt;&#38;gt; &#34;%temp%\\getadmin.vbs&#34;&#10;&#10;&#34;%temp%\\getadmin.vbs&#34;&#10;Exit &#10;&#10;:gotAdmin&#10;if exist &#34;%temp%\\getadmin.vbs&#34; ( Del &#34;%temp%\\getadmin.vbs&#34; )&#10;Pushd &#34;%CD%&#34;&#10;CD /D &#34;%~dp0&#34;&#10;:--------------------------------------&#10;cmd.exe /k %*</span><br></pre></td></tr></table></figure>\n<p>类似的也可以用ls.bat来模拟Linux的ls命令，就不用担心习惯ls手抖打错了：</p>\n<figure class=\"highlight\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">@echo off&#10;dir %*</span><br></pre></td></tr></table></figure>\n","date":"2012-05-11T04:00:43.000Z","path":"2012/05/11/windows-sudo-batch/","isDark":true,"featureColor":"#266cb4","featureImage":"/image/stock/1.jpg","excerpt":"<p>在Windows下运行某些命令的时候，必须要管理员权限。每次要重新选择“以管理员权限运行”很不方便而且没有效率，于是写了一个批处理文件，实现类似Linux下的sudo命令。</p>\n<p>保存为sudo.bat，放在环境变量PATH中指定的任意一个文件夹下，在命令行窗口中输入：</p>\n<blockquote>\n<p>sudo [command line]</p>\n</blockquote>\n<p>就会出现UAC对话框，确认后就会以管理员权限执行指定的命令。</p>","featureSwatch":{"Vibrant":{"color":"#266cb4","isDark":true,"contrast":5.450121616568956},"Muted":{"color":"#4b70a6","isDark":true,"contrast":5.296212493095912},"DarkVibrant":{"color":"#3260a1","isDark":true,"contrast":10.521199995853594},"DarkMuted":{"color":"#515787","isDark":true,"contrast":11.462157427934459},"LightVibrant":{"color":"#5791c6","isDark":true,"contrast":3.512948192359975},"LightMuted":{"color":"#9bb4cc","isDark":false,"contrast":2.144138719552091}},"json":"data/posts/2012/05/11/windows-sudo-batch.json","tags":[{"name":"Linux","slug":"Linux","path":"tags/Linux/","permalink":"http://catx.me/tags/Linux/","postCount":1},{"name":"sudo","slug":"sudo","path":"tags/sudo/","permalink":"http://catx.me/tags/sudo/","postCount":1},{"name":"命令行","slug":"命令行","path":"tags/命令行/","permalink":"http://catx.me/tags/命令行/","postCount":1},{"name":"管理","slug":"管理","path":"tags/管理/","permalink":"http://catx.me/tags/管理/","postCount":1}],"categories":[{"name":"挨踢","slug":"挨踢","path":"categories/挨踢/","permalink":"http://catx.me/categories/挨踢/","postCount":24}]},"sha1":"872807fe615e745e86f8f737f22de590a48520f0","isDigest":true}],"sha1":"f2bb7d11d62b815a23f364c63e65c2948b6f29d7"}